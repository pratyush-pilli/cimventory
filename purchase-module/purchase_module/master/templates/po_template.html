<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Purchase Order - {{ po_details.po_number }}</title>
    <style>
      body {
        font-family: Arial, sans-serif;
        line-height: 1.6;
        color: #333;
      }
      .container {
        max-width: 1200px;
        margin: 0 auto;
        padding: 20px;
      }
      .header {
        text-align: center;
        margin-bottom: 30px;
        border-bottom: 2px solid #333;
        padding-bottom: 20px;
      }
      .company-title {
        font-size: 24px;
        font-weight: bold;
        margin-bottom: 10px;
      }
      .po-title {
        text-align: center;
        font-size: 20px;
        font-weight: bold;
        margin: 20px 0;
        text-decoration: underline;
      }
      .info-grid {
        display: grid;
        grid-template-columns: repeat(3, 1fr);
        gap: 20px;
        margin-bottom: 30px;
      }
      .info-box {
        border: 1px solid #ddd;
        padding: 15px;
        border-radius: 5px;
      }
      .info-box h3 {
        margin-top: 0;
        border-bottom: 1px solid #ddd;
        padding-bottom: 5px;
      }
      table {
        width: 100%;
        border-collapse: collapse;
        margin-bottom: 20px;
      }
      th,
      td {
        border: 1px solid #ddd;
        padding: 8px;
        text-align: left;
      }
      th {
        background-color: #f5f5f5;
      }
      .amount-row {
        font-weight: bold;
      }
      .amount-in-words {
        font-style: italic;
        margin: 10px 0;
      }
      .terms-section {
        margin: 20px 0;
      }
      .signature-section {
        margin-top: 50px;
        text-align: right;
      }
      .text-right {
        text-align: right;
      }
      .text-center {
        text-align: center;
      }
    </style>
  </head>
  <body>
    <div class="container">
      <div class="header">
        <div class="company-title">CIMCON Software India Pvt. Ltd.</div>
        <div>{{ invoice_details.address }}</div>
        <div>GSTIN: {{ invoice_details.gstin }}</div>
      </div>

      <div class="po-title">PURCHASE ORDER</div>

      <div class="info-grid">
        <div class="info-box">
          <h3>Vendor Details</h3>
          <p><strong>Name:</strong> {{ vendor_details.name }}</p>
          <p><strong>Address:</strong> {{ vendor_details.address }}</p>
          <p><strong>Email:</strong> {{ vendor_details.email }}</p>
          <p><strong>Contact:</strong> {{ vendor_details.contact }}</p>
          <p><strong>GSTIN:</strong> {{ vendor_details.gstin }}</p>
        </div>

        <div class="info-box">
          <h3>Consignee Details</h3>
          <p><strong>Name:</strong> {{ consignee_details.name }}</p>
          <p><strong>Address:</strong> {{ consignee_details.address }}</p>
          <p><strong>Mobile:</strong> {{ consignee_details.mobile }}</p>
          <p><strong>Attention:</strong> {{ consignee_details.attention }}</p>
        </div>

        <div class="info-box">
          <h3>PO Details</h3>
          <p><strong>PO Number:</strong> {{ po_details.po_number }}</p>
          <p><strong>PO Date:</strong> {{ po_details.po_date }}</p>
          <p><strong>Quote Ref:</strong> {{ po_details.quote_ref_number }}</p>
          <p><strong>Project Code:</strong> {{ po_details.project_code }}</p>
        </div>
      </div>

      <table>
        <thead>
          <tr>
            <th>Sr. No.</th>
            <th>Item No.</th>
            <th>Description</th>
            <th>Make</th>
            <th>Material Group</th>
            <th class="text-right">Quantity</th>
            <th class="text-right">Unit Price (₹)</th>
            <th class="text-right">Total (₹)</th>
          </tr>
        </thead>
        <tbody>
          {% for item in line_items %}
          <tr>
            <td class="text-center">{{ item.sr_no }}</td>
            <td>{{ item.item_no }}</td>
            <td>{{ item.description }}</td>
            <td>{{ item.make }}</td>
            <td>{{ item.material_group }}</td>
            <td class="text-right">{{ item.quantity }}</td>
            <td class="text-right">{{ item.unit_price|floatformat:2 }}</td>
            <td class="text-right">{{ item.total_price|floatformat:2 }}</td>
          </tr>
          {% endfor %}
          <tr class="amount-row">
            <td colspan="7" class="text-right">Total Amount:</td>
            <td class="text-right">
              ₹ {{ totals.total_amount|floatformat:2 }}
            </td>
          </tr>
        </tbody>
      </table>

      <div class="amount-in-words">
        Amount in Words: {{ totals.amount_in_words }}
      </div>

      <div class="terms-section">
        <h3>Terms and Conditions</h3>
        <p><strong>Payment Terms:</strong> {{ terms.payment }}</p>
        <p><strong>Warranty Terms:</strong> {{ terms.warranty }}</p>
        <p><strong>Delivery Schedule:</strong> {{ terms.delivery }}</p>
        <p><strong>Dispatch Terms:</strong> {{ terms.dispatch }}</p>
        <p><strong>TPI Terms:</strong> {{ terms.tpi }}</p>
        <p><strong>Installation Terms:</strong> {{ terms.installation }}</p>
      </div>

      {% if po_details.notes != 'NA' %}
      <div class="terms-section">
        <h3>Notes</h3>
        <p>{{ po_details.notes }}</p>
      </div>
      {% endif %}

      <div class="signature-section">
        <p>For CIMCON Software India Pvt. Ltd.</p>
        <br /><br /><br />
        <p><strong>Authorized Signatory</strong></p>
        <p>Jutan Sharma</p>
        <p>Director – SCM and Operations</p>
      </div>
    </div>
  </body>
</html>
