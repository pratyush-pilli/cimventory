<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>Purchase Order - {{ po_details.poNumber }}</title>
    <style>
      * {
        margin: 0;
        padding: 0;
        font-family: Arial, sans-serif;
        font-size: 14px;
        line-height: 1.5;
      }

      .outer-box {
        margin: 0 auto 20px auto;
        max-width: 800px;
        border: 1px solid #000;
        padding: 10px;
      }

      .header {
        text-align: left;
      }

      .header img {
        max-width: 100%;
        height: auto;
        opacity: 0.7;
      }

      .header h1 {
        margin: 20px 0 10px 0;
        text-align: center;
        font-weight: bold;
        font-size: 24px;
      }

      .section {
        margin-top: 20px;
      }
      .details-table,
      .items-table {
        width: 100%;
        border-collapse: collapse;
        margin-top: 10px;
      }
      .details-table td,
      .items-table td,
      .items-table th {
        border: 1px solid #000;
        padding: 5px;
        vertical-align: top;
        text-align: center;
      }
      .items-table th {
        background-color: #868686;
        text-align: center;
        color: #fff;
      }
      .totals {
        margin-top: 20px;
      }
      .totals td {
        padding: 5px;
        border: 1px solid #000;
      }
      .small-text {
        font-size: 12px;
        color: #333;
      }
      .bold {
        font-weight: bold;
      }

      h6 {
        margin: 0 0 10px 0;
        font-weight: normal;
      }

      .po-details tr th,
      .po-details tr td {
        text-align: left;
        line-height: 0.9;
        border: 0;
        border-bottom: 1px solid #000;
        padding-left: 10px;
      }

      .po-details tr th {
        border-right: 1px solid #000;
      }

      .po-address tr:last-child td {
        border-bottom: 0;
        border-left: 0;
        border-right: 0;
      }

      .po-address tr:first-child td {
        border: 0;
      }

      .po-address tr td {
        text-align: left;
        padding: 10px;
      }

      .po-details tr:first-child tr:last-child th,
      .po-details tr:first-child tr:last-child td {
        border-bottom: 0;
      }

      .po-details tr:last-child th,
      .po-details tr:last-child td {
        border-bottom: 0;
      }

      .section.table-section {
        margin-left: -11px;
        margin-right: -11px;
      }

      .info-message {
        color: #0066ff;
        font-weight: 600;
        font-style: italic;
        vertical-align: top;
        padding-top: 20px;
      }

      .home-footer img {
        max-width: 100px;
        display: table;
        margin: 0 auto;
      }

      .section.home-footer {
        margin-top: 50px;
      }

      .section.home-footer span {
        text-align: right;
        display: block;
      }

      .section.home-footer tr td {
        border: 1px solid #000;
        padding: 10px;
      }

      .section.home-footer tr td:first-child {
        border-right: 0;
      }

      .page-index {
        text-align: right;
        padding: 10px 0 0 10px;
        color: #666;
      }

      .page-index span {
        color: #000;
      }

      .terms-conditions ol {
        padding-left: 20px;
      }

      .terms-conditions ol li {
        margin: 0 0 10px 0;
      }
    </style>
  </head>
  <body>
    <div class="outer-box">
      <div class="header">
        <img src="{{ company_logo_url }}" />
        <h1>PURCHASE ORDER</h1>
      </div>

      <div class="section table-section">
        <table
          class="details-table"
          style="width: 100%"
          cellspacing="0"
          cellpadding="0"
        >
          <tr>
            <td style="width: 50%; padding: 0" class="po-address">
              <table style="width: 100%" cellspacing="0" cellpadding="0">
                <tr>
                  <td align="left">
                    <h6>Supplier Details:</h6>
                    <b>{{ supplier.name }}</b><br />
                    {{ supplier.address|linebreaksbr }}<br />
                    Kind Attention: {{ supplier.contact_person }} ({{
                    supplier.contact_number }})<br />
                    Email: {{ supplier.email }}<br />
                    GST: <b>{{ supplier.gstin }}</b><br />
                    PAN No: <b>{{ supplier.pan }}</b><br />
                    State: <b>{{ supplier.state }}</b>. State Code:
                    <b>{{ supplier.state_code }}</b>
                  </td>
                </tr>

                <tr>
                  <td align="left">
                    <h6>Billing Address:</h6>
                    <b>{{ billing_address.company_name }}</b><br />
                    {{ billing_address.address|linebreaksbr }}<br />
                    GST: <b>{{ billing_address.gstin }}</b><br />
                    PAN No: <b>{{ billing_address.pan }}</b><br />
                    State: <b>{{ billing_address.state }}</b><br />
                    State Code: <b>{{ billing_address.state_code }}</b>
                  </td>
                </tr>
              </table>
            </td>
            <td style="width: 50%; padding: 0" cellspacing="0" cellpadding="0">
              <table
                class="po-details"
                style="width: 100%"
                cellspacing="0"
                cellpadding="0"
              >
                <tr>
                  <td style="padding: 0">
                    <table style="width: 100%" cellspacing="0" cellpadding="0">
                      <tr>
                        <th>CIMCON PO Number</th>
                        <td>{{ po_details.poNumber }}</td>
                      </tr>
                      <tr>
                        <th>PO Date</th>
                        <td>{{ po_details.poDate|date:"d F Y" }}</td>
                      </tr>
                      <tr>
                        <th>PO Version</th>
                        <td>{{ po_details.version }}</td>
                      </tr>
                      <tr>
                        <th>Quote Ref. Number</th>
                        <td>{{ po_details.quoteRef }}</td>
                      </tr>
                      <tr>
                        <th>Project Code</th>
                        <td>{{ po_details.projectCode }}</td>
                      </tr>
                      <tr>
                        <th>Freight & Insurance</th>
                        <td>{{ po_details.freightAndInsurance }}</td>
                      </tr>
                      <tr>
                        <th>Payment Terms</th>
                        <td>{{ po_details.paymentTerms }}</td>
                      </tr>
                      <tr>
                        <th>Guarantee/Warranty</th>
                        <td>{{ po_details.warranty }}</td>
                      </tr>
                      <tr>
                        <th>TPI Inspection</th>
                        <td>{{ po_details.tpiInspection }}</td>
                      </tr>
                      <tr>
                        <th>Installation</th>
                        <td>{{ po_details.installation }}</td>
                      </tr>
                      <tr>
                        <th>Commissioning</th>
                        <td>{{ po_details.commissioning }}</td>
                      </tr>
                      <tr>
                        <th>Delivery Schedule</th>
                        <td>{{ po_details.deliverySchedule }}</td>
                      </tr>
                      <tr>
                        <th>Vendor Code</th>
                        <td>{{ po_details.vendorCode|default:"&nbsp;" }}</td>
                      </tr>
                    </table>
                  </td>
                </tr>
                <tr>
                  <td>
                    <h6>Delivery Address:</h6>
                    <b>{{ delivery_address.company_name }}</b><br />
                    {{ delivery_address.address|linebreaksbr }}<br />
                    Contact: {{ delivery_address.contact_person }}, Ph. - {{
                    delivery_address.contact_number }}
                  </td>
                </tr>
              </table>
            </td>
          </tr>
        </table>

        <table
          border="1"
          cellspacing="0"
          cellpadding="5"
          style="
            border-collapse: collapse;
            width: 100%;
            font-family: Arial;
            font-size: 14px;
          "
        >
          <thead style="background-color: #d9d9d9; text-align: center">
            <tr>
              <th>S/N</th>
              <th>CIMCON P/N</th>
              <th style="width: 130px">Description</th>
              <th>HSN/SAC</th>
              <th>Qty.</th>
              <th>Unit Rate</th>
              <th>Taxable Value</th>
              <th>GST</th>
              <th>Total Amount</th>
            </tr>
          </thead>
          <tbody>
            {% for item in items %}
            <tr>
              <td align="center">{{ forloop.counter }}</td>
              <td>{{ item.cimconPartNo }}</td>
              <td>{{ item.description }}</td>
              <td>{{ item.hsnSac }}</td>
              <td align="center">{{ item.quantity }} {{ item.uom }}</td>
              <td align="center">
                {{ currency_symbol }}{{ item.unitRate|floatformat:2 }}
              </td>
              <td align="center">
                {{ currency_symbol }}{{ item.taxableValue|floatformat:2 }}
              </td>
              <td align="center">
                {{ currency_symbol }}{{ item.gst|floatformat:2 }}
              </td>
              <td align="center">
                {{ currency_symbol }}{{ item.totalAmount|floatformat:2 }}
              </td>
            </tr>
            {% endfor %}
            <tr style="font-weight: bold">
              <td colspan="4" align="center">Total ({{ currency_code }})</td>
              <td align="center">{{ totals.total_quantity }}</td>
              <td></td>
              <td align="center">
                {{ currency_symbol }}{{ totals.total_taxable_value|floatformat:2
                }}
              </td>
              <td align="center">
                {{ currency_symbol }}{{ totals.total_gst|floatformat:2 }}
              </td>
              <td align="center">
                {{ currency_symbol }}{{ totals.total_amount|floatformat:2 }}
              </td>
            </tr>
            <tr>
              <td colspan="6" rowspan="4"></td>
              <td colspan="2" align="center">Taxable Value</td>
              <td align="center">
                {{ currency_symbol }}{{ totals.total_taxable_value|floatformat:2
                }}
              </td>
            </tr>
            <tr>
              <td colspan="2" align="center">GST</td>
              <td align="center">
                {{ currency_symbol }}{{ totals.total_gst|floatformat:2 }}
              </td>
            </tr>
            <tr>
              <td colspan="2" align="center">Round Off</td>
              <td align="center">
                {{ currency_symbol }}{{ totals.round_off|floatformat:2 }}
              </td>
            </tr>
            <tr style="font-weight: bold; background-color: #d9d9d9">
              <td colspan="2" align="center">Total</td>
              <td align="center">
                {{ currency_symbol }}{{ totals.final_amount|floatformat:2 }}
              </td>
            </tr>
            <tr style="background-color: #d9d9d9">
              <td colspan="9" style="padding-left: 10px; padding-right: 10px">
                {{ amount_in_words }}
              </td>
            </tr>
          </tbody>
        </table>
      </div>

      <div class="section home-footer">
        <table style="width: 100%" cellspacing="0" cellpadding="0">
          <tr>
            <td class="info-message">{{ footer_message }}</td>
            <td style="width: 300px">
              for {{ company_name }}<br />
              <img src="{{ signature_url }}" />
              {{ signatory.name }}<br />
              {{ signatory.designation }}<br />
              <span style="text-align: right">{{ signatory.title }}</span>
            </td>
          </tr>
        </table>
      </div>
      <div class="page-index"><span>1</span> | Page</div>
    </div>

    <!-- Terms and Conditions page -->
    <div class="outer-box">
      <div class="header">
        <img src="{{ company_logo_url }}" />
        <h1>Commercial Terms & Conditions</h1>
      </div>

      <div class="section terms-conditions">
        <ol>
          {% for term in terms_and_conditions %}
          <li><b>{{ term.title }}:</b> {{ term.content }}</li>
          {% endfor %}
        </ol>
      </div>

      <div class="section home-footer">
        <table style="width: 100%" cellspacing="0" cellpadding="0">
          <tr>
            <td class="info-message">{{ footer_message }}</td>
            <td style="width: 300px">
              for {{ company_name }}<br />
              <img src="{{ signature_url }}" />
              {{ signatory.name }}<br />
              {{ signatory.designation }}<br />
              <span style="text-align: right">{{ signatory.title }}</span>
            </td>
          </tr>
        </table>
      </div>
      <div class="page-index"><span>2</span> | Page</div>
    </div>
  </body>
</html>
